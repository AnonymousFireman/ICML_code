function B = Hadamard8(A)
%
% B = H_8 A

t1 = A(1: 2, :) + A(3: 4, :);
t2 = A(1: 2, :) - A(3: 4, :);
t3 = A(5: 6, :) + A(7: 8, :);
t4 = A(5: 6, :) - A(7: 8, :);
u1 = t1 + t3;
u2 = t2 + t4;
u3 = t1 - t3;
u4 = t2 - t4;
B = zeros(size(A, 1), size(A, 2));
B(1, :) = u1(1, :) + u1(2, :);
B(2, :) = u1(1, :) - u1(2, :);
B(3, :) = u2(1, :) + u2(2, :);
B(4, :) = u2(1, :) - u2(2, :);
B(5, :) = u3(1, :) + u3(2, :);
B(6, :) = u3(1, :) - u3(2, :);
B(7, :) = u4(1, :) + u4(2, :);
B(8, :) = u4(1, :) - u4(2, :);